import{r as H,a as J,__tla as W}from"./config-3fd8b39b.js";import{r as X,C as q,__tla as Z}from"./config-70d809c5.js";import{_ as ee}from"./ControlTableColumnsBtn.vue_vue_type_script_setup_true_lang-5cc07372.js";import{u as D}from"./vue-i18n-03843db8.js";import"./vuedraggable-e80cb101.js";import{a as w,__tla as ae}from"./index-81bcbc0d.js";import{m as te}from"./ant-design-vue-bed7d465.js";import{d as E,e as le,j as n,w as oe,aY as _,aQ as b,ab as x,c as a,bu as p,E as V,b8 as g,u as C,aI as F,r as ne,ac as B,F as re,aa as I,a9 as ie}from"./@vue-3199b24e.js";import{_ as ue,T as se}from"./@ant-design-5e74ab0d.js";import"./@intlify-f45a2def.js";import"./dayjs-c16566d5.js";import"./vue-ff5fdb07.js";import"./sortablejs-471eb17c.js";import"./pinia-d1156740.js";import"./vue-router-60a88f34.js";import"./axios-82afda87.js";import"./nprogress-afa1df2f.js";import"./@babel-727ea1f3.js";import"./@ctrl-fb5a5473.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-fad5b415.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-0b7bf9f6.js";import"./dom-align-ecb06dd6.js";import"./lodash-es-fa11e39e.js";import"./async-validator-7f96df71.js";import"./throttle-debounce-87e7e444.js";let G,de=Promise.all([(()=>{try{return W}catch{}})(),(()=>{try{return Z}catch{}})(),(()=>{try{return ae}catch{}})()]).then(async()=>{function M(S){const c=[];function u(f){for(const s of f)s.children?u(s.children):c.push(s.id)}return u(S),c}let j,A,K,N,O,T;j=E({__name:"AddRole",props:{modelValue:{type:Boolean,default:!1},title:{type:String,required:!0},info:{type:Object,default:()=>{}}},emits:["update:modelValue","getList"],setup(S,{emit:c}){const u=S,{t:f}=D(),s=le({get:()=>u.modelValue,set:t=>{c("update:modelValue",t)}}),L=n({formItems:X,formName:"role",colStyle:{sm:24},formLabelCol:{span:4},showCollapsed:!1,showResetBtn:!1,showSubmitBtn:!1}),l=n(),o=n({name:"",intro:""});oe(()=>u.info,t=>{u.info.id?m.value=M(t.menuList):m.value=[],Object.keys(o.value).forEach(r=>{o.value[r]=t[r]})});const m=n([]),k={title:"name",key:"id"},y=n([]);w.getMenuList().then(t=>{y.value=t.data.list});const z=()=>{if(!m.value.length)return te.warn(f("form.selectIntro"));l.value.submit()},U=async()=>{const t={...o.value,menuList:m.value};u.info.id?await w.editRole(t,u.info.id):await w.addRole(t),c("getList"),m.value=[],l.value.reset(),s.value=!1};return(t,r)=>{const e=_("a-tree"),d=_("a-button"),v=_("a-modal");return b(),x("div",null,[a(v,{open:s.value,"onUpdate:open":r[2]||(r[2]=h=>s.value=h),title:S.title,destroyOnClose:""},{footer:p(()=>[a(d,{type:"primary",size:"small",onClick:z},{default:p(()=>[V(g(t.$t("form.submit")),1)]),_:1})]),default:p(()=>[a(C(q),F(L.value,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=h=>o.value=h),onSubmit:U,ref_key:"formRef",ref:l}),null,16,["modelValue"]),a(e,{checkedKeys:m.value,"onUpdate:checkedKeys":r[1]||(r[1]=h=>m.value=h),"tree-data":y.value,"field-names":k,checkable:""},null,8,["checkedKeys","tree-data"])]),_:1},8,["open","title"])])}}}),A={class:"search-form"},K={class:"mt-20"},N={class:"options"},O={key:1},T={key:2},G=E({__name:"Role",setup(S){const{t:c}=D(),u=n({formName:"roleList",formItems:H,formLabelCol:{sm:{span:8}}}),f=n({name:"",intro:""}),s=n([]),L=n([]),l=ne({total:0,current:1,pageSize:10}),o=()=>{w.getRoleList({offset:l.pageSize*l.current-l.pageSize,size:l.pageSize,...f.value},{showLoading:!0}).then(e=>{const{list:d,totalCount:v}=e.data;s.value=d,l.total=v})},m=e=>{l.current=e.current,l.pageSize=e.pageSize,o()};o();const k=n(!1),y=n(""),z=n({}),U=()=>{k.value=!0,y.value=c("role.addRole"),z.value={}},t=e=>{w.delRole(e).then(()=>{o()})},r=e=>{k.value=!0,y.value=c("role.editRole"),z.value=e};return(e,d)=>{const v=_("a-button"),h=_("a-switch"),P=_("a-space"),Q=_("a-table");return b(),x("div",null,[B("div",A,[a(C(q),F(u.value,{modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=i=>f.value=i),onSubmit:o,onReset:o}),null,16,["modelValue"])]),B("div",K,[B("div",N,[a(v,{class:"mr-10",type:"primary",size:"small",onClick:U},{default:p(()=>[V(g(e.$t("form.add")),1)]),_:1}),a(C(ee),{columns:C(J),tableColumns:L.value,"onUpdate:tableColumns":d[1]||(d[1]=i=>L.value=i)},null,8,["columns","tableColumns"])]),a(Q,{columns:L.value,dataSource:s.value,pagination:l,scroll:{x:"max-content"},onChange:m},{bodyCell:p(({column:i,record:R,index:Y})=>[i.dataIndex==="index"?(b(),x(re,{key:0},[V(g(Y+1),1)],64)):I("",!0),i.dataIndex==="enable"?(b(),x("span",O,[a(h,{"checked-children":e.$t("form.start"),"un-checked-children":e.$t("form.disable"),checkedValue:1,unCheckedValue:0,checked:R.enable,"onUpdate:checked":$=>R.enable=$},null,8,["checked-children","un-checked-children","checked","onUpdate:checked"])])):I("",!0),["createAt","updateAt"].includes(i.dataIndex)?(b(),x("span",T,g(e.$filters.formatTime(R[i.dataIndex])),1)):I("",!0),["action"].includes(i.dataIndex)?(b(),ie(P,{key:3,wrap:""},{default:p(()=>[a(v,{size:"small",type:"link",onClick:$=>r(R)},{default:p(()=>[a(C(ue)),V(g(e.$t("form.edit")),1)]),_:2},1032,["onClick"]),a(v,{size:"small",type:"link",danger:"",onClick:$=>t(R.id)},{default:p(()=>[a(C(se)),V(" "+g(e.$t("form.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)):I("",!0)]),_:1},8,["columns","dataSource","pagination"])]),a(j,{modelValue:k.value,"onUpdate:modelValue":d[2]||(d[2]=i=>k.value=i),title:y.value,info:z.value,onGetList:o},null,8,["modelValue","title","info"])])}}})});export{de as __tla,G as default};
