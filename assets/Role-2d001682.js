import{r as H,a as Q,__tla as W}from"./config-9ee1b371.js";import{C as q,__tla as X}from"./CustomForm-5a96f7e1.js";import{_ as Z}from"./ControlTableColumnsBtn.vue_vue_type_script_setup_true_lang-d96359ca.js";import{a as w,__tla as ee}from"./index-d5260169.js";import"./echarts-50c08647.js";import"./@wangeditor-2dbc72d1.js";import{u as E}from"./vue-i18n-50aabb0e.js";import"./vuedraggable-1d38634b.js";import{r as ae,__tla as te}from"./config-0ede8a46.js";import{m as le}from"./ant-design-vue-4b8e1ea3.js";import{d as F,l as oe,r as n,w as ne,aY as _,a as b,b as x,c as a,bu as p,I as V,b8 as g,u as C,aJ as G,f as re,ad as A,F as ie,ac as I,ab as ue}from"./@vue-249e6205.js";import{_ as se,T as me}from"./@ant-design-1a91f59a.js";import"./pinia-b4bb1fe0.js";import"./dayjs-c16566d5.js";import"./vue-router-6d605675.js";import"./axios-82afda87.js";import"./nprogress-afa1df2f.js";import"./@babel-727ea1f3.js";import"./@ctrl-fb5a5473.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-fad5b415.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-0b7bf9f6.js";import"./dom-align-ecb06dd6.js";import"./lodash-es-fa11e39e.js";import"./async-validator-7f96df71.js";import"./throttle-debounce-87e7e444.js";import"./@intlify-f45a2def.js";import"./zrender-facebe63.js";import"./vue-168dcdc7.js";import"./sortablejs-471eb17c.js";let J,de=Promise.all([(()=>{try{return W}catch{}})(),(()=>{try{return X}catch{}})(),(()=>{try{return ee}catch{}})(),(()=>{try{return te}catch{}})()]).then(async()=>{function M(S){const c=[];function u(f){for(const s of f)s.children?u(s.children):c.push(s.id)}return u(S),c}let B,N,O,j,K,T;B=F({__name:"AddRole",props:{modelValue:{type:Boolean,default:!1},title:{type:String,required:!0},info:{type:Object,default:()=>{}}},emits:["update:modelValue","getList"],setup(S,{emit:c}){const u=S,{t:f}=E(),s=oe({get:()=>u.modelValue,set:t=>{c("update:modelValue",t)}}),L=n({formItems:ae,formName:"role",colStyle:{sm:24},formLabelCol:{span:4},showCollapsed:!1,showResetBtn:!1,showSubmitBtn:!1}),l=n(),o=n({name:"",intro:""});ne(()=>u.info,t=>{u.info.id?d.value=M(t.menuList):d.value=[],Object.keys(o.value).forEach(r=>{o.value[r]=t[r]})});const d=n([]),k={title:"name",key:"id"},y=n([]);w.getMenuList().then(t=>{y.value=t.data.list});const z=()=>{if(!d.value.length)return le.warn(f("form.selectIntro"));l.value.submit()},U=async()=>{const t={...o.value,menuList:d.value};u.info.id?await w.editRole(t,u.info.id):await w.addRole(t),c("getList"),d.value=[],l.value.reset(),s.value=!1};return(t,r)=>{const e=_("a-tree"),m=_("a-button"),v=_("a-modal");return b(),x("div",null,[a(v,{open:s.value,"onUpdate:open":r[2]||(r[2]=h=>s.value=h),title:S.title,destroyOnClose:""},{footer:p(()=>[a(m,{type:"primary",size:"small",onClick:z},{default:p(()=>[V(g(t.$t("form.submit")),1)]),_:1})]),default:p(()=>[a(C(q),G(L.value,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=h=>o.value=h),onSubmit:U,ref_key:"formRef",ref:l}),null,16,["modelValue"]),a(e,{checkedKeys:d.value,"onUpdate:checkedKeys":r[1]||(r[1]=h=>d.value=h),"tree-data":y.value,"field-names":k,checkable:""},null,8,["checkedKeys","tree-data"])]),_:1},8,["open","title"])])}}}),N={class:"search-form"},O={class:"mt-20"},j={class:"options"},K={key:1},T={key:2},J=F({__name:"Role",setup(S){const{t:c}=E(),u=n({formName:"roleList",formItems:H,formLabelCol:{sm:{span:8}}}),f=n({name:"",intro:""}),s=n([]),L=n([]),l=re({total:0,current:1,pageSize:10}),o=()=>{w.getRoleList({offset:l.pageSize*l.current-l.pageSize,size:l.pageSize,...f.value},{showLoading:!0}).then(e=>{const{list:m,totalCount:v}=e.data;s.value=m,l.total=v})},d=e=>{l.current=e.current,l.pageSize=e.pageSize,o()};o();const k=n(!1),y=n(""),z=n({}),U=()=>{k.value=!0,y.value=c("role.addRole"),z.value={}},t=e=>{w.delRole(e).then(()=>{o()})},r=e=>{k.value=!0,y.value=c("role.editRole"),z.value=e};return(e,m)=>{const v=_("a-button"),h=_("a-switch"),P=_("a-space"),Y=_("a-table");return b(),x("div",null,[A("div",N,[a(C(q),G(u.value,{modelValue:f.value,"onUpdate:modelValue":m[0]||(m[0]=i=>f.value=i),onSubmit:o,onReset:o}),null,16,["modelValue"])]),A("div",O,[A("div",j,[a(v,{class:"mr-10",type:"primary",size:"small",onClick:U},{default:p(()=>[V(g(e.$t("form.add")),1)]),_:1}),a(C(Z),{columns:C(Q),tableColumns:L.value,"onUpdate:tableColumns":m[1]||(m[1]=i=>L.value=i)},null,8,["columns","tableColumns"])]),a(Y,{columns:L.value,dataSource:s.value,pagination:l,scroll:{x:"max-content"},onChange:d},{bodyCell:p(({column:i,record:R,index:D})=>[i.dataIndex==="index"?(b(),x(ie,{key:0},[V(g(D+1),1)],64)):I("",!0),i.dataIndex==="enable"?(b(),x("span",K,[a(h,{"checked-children":e.$t("form.start"),"un-checked-children":e.$t("form.disable"),checkedValue:1,unCheckedValue:0,checked:R.enable,"onUpdate:checked":$=>R.enable=$},null,8,["checked-children","un-checked-children","checked","onUpdate:checked"])])):I("",!0),["createAt","updateAt"].includes(i.dataIndex)?(b(),x("span",T,g(e.$filters.formatTime(R[i.dataIndex])),1)):I("",!0),["action"].includes(i.dataIndex)?(b(),ue(P,{key:3,wrap:""},{default:p(()=>[a(v,{size:"small",type:"link",onClick:$=>r(R)},{default:p(()=>[a(C(se)),V(g(e.$t("form.edit")),1)]),_:2},1032,["onClick"]),a(v,{size:"small",type:"link",danger:"",onClick:$=>t(R.id)},{default:p(()=>[a(C(me)),V(" "+g(e.$t("form.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)):I("",!0)]),_:1},8,["columns","dataSource","pagination"])]),a(B,{modelValue:k.value,"onUpdate:modelValue":m[2]||(m[2]=i=>k.value=i),title:y.value,info:z.value,onGetList:o},null,8,["modelValue","title","info"])])}}})});export{de as __tla,J as default};
