import{a as ee,r as ae,u as U,b as te,__tla as le}from"./usePermissions-d4a90d82.js";import{C as G,__tla as oe}from"./CustomForm-1969ae2f.js";import{_ as re}from"./ControlTableColumnsBtn.vue_vue_type_script_setup_true_lang-2e2c1a3a.js";import{a as w,__tla as ue}from"./index-5bb4b2fa.js";import"./echarts-50c08647.js";import"./@wangeditor-2dbc72d1.js";import{u as J}from"./vue-i18n-50aabb0e.js";import"./vuedraggable-b7d04458.js";import{r as ie,__tla as ne}from"./config-464420d7.js";import{m as se}from"./ant-design-vue-935c8d6a.js";import{d as M,l as me,r as o,w as de,aY as _,a as n,b,c as i,bu as c,I,b8 as g,u as s,aJ as P,f as ce,ac as p,ad as Y,ab as $,F as pe}from"./@vue-249e6205.js";import{_ as fe,T as ve}from"./@ant-design-1a91f59a.js";import"./pinia-b4bb1fe0.js";import"./dayjs-5f4ee36c.js";import"./vue-router-6d605675.js";import"./axios-82afda87.js";import"./nprogress-5dddbdfe.js";import"./@babel-727ea1f3.js";import"./@ctrl-fb5a5473.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-fad5b415.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-0b7bf9f6.js";import"./dom-align-ecb06dd6.js";import"./lodash-es-fa11e39e.js";import"./async-validator-7f96df71.js";import"./throttle-debounce-87e7e444.js";import"./@intlify-f45a2def.js";import"./zrender-facebe63.js";import"./vue-ec32c1ec.js";import"./sortablejs-83e3dbbd.js";let H,_e=Promise.all([(()=>{try{return le}catch{}})(),(()=>{try{return oe}catch{}})(),(()=>{try{return ue}catch{}})(),(()=>{try{return ne}catch{}})()]).then(async()=>{let T,j,q,F,D,E;T=M({__name:"AddRole",props:{modelValue:{type:Boolean,default:!1},title:{type:String,required:!0},info:{type:Object,default:()=>{}}},emits:["update:modelValue","getList"],setup(R,{emit:C}){const f=R,{t:V}=J(),h=me({get:()=>f.modelValue,set:a=>{C("update:modelValue",a)}}),S=o({formItems:ie,formName:"role",colStyle:{sm:24},formLabelCol:{span:4},showCollapsed:!1,showResetBtn:!1,showSubmitBtn:!1}),t=o(),l=o({name:"",intro:""});de(()=>f.info,a=>{f.info.id?m.value=ee(a.menuList):m.value=[],Object.keys(l.value).forEach(r=>{l.value[r]=a[r]})});const m=o([]),k={title:"name",key:"id"},y=o([]);w.getMenuList().then(a=>{y.value=a.data.list});const L=()=>{if(!m.value.length)return se.warn(V("form.selectIntro"));t.value.submit()},B=async()=>{const a={...l.value,menuList:m.value};f.info.id?await w.editRole(a,f.info.id):await w.addRole(a),C("getList"),m.value=[],t.value.reset(),h.value=!1};return(a,r)=>{const A=_("a-tree"),K=_("a-button"),N=_("a-modal");return n(),b("div",null,[i(N,{open:h.value,"onUpdate:open":r[2]||(r[2]=v=>h.value=v),title:R.title,destroyOnClose:""},{footer:c(()=>[i(K,{type:"primary",size:"small",onClick:L},{default:c(()=>[I(g(a.$t("form.submit")),1)]),_:1})]),default:c(()=>[i(s(G),P(S.value,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=v=>l.value=v),onSubmit:B,ref_key:"formRef",ref:t}),null,16,["modelValue"]),i(A,{checkedKeys:m.value,"onUpdate:checkedKeys":r[1]||(r[1]=v=>m.value=v),"tree-data":y.value,"field-names":k,checkable:""},null,8,["checkedKeys","tree-data"])]),_:1},8,["open","title"])])}}}),j={key:0,class:"search-form"},q={class:"mt-20"},F={class:"options"},D={key:1},E={key:2},H=M({__name:"Role",setup(R){const{t:C}=J(),f=o({formName:"roleList",formItems:ae,formLabelCol:{sm:{span:8}}}),V=o({name:"",intro:""}),h=o([]),S=o([]),t=ce({total:0,current:1,pageSize:10}),l=()=>{w.getRoleList({offset:t.pageSize*t.current-t.pageSize,size:t.pageSize,...V.value},{showLoading:!0}).then(e=>{const{list:d,totalCount:x}=e.data;h.value=d,t.total=x})},m=e=>{t.current=e.current,t.pageSize=e.pageSize,l()};l();const k=o(!1),y=o(""),L=o({}),B=()=>{k.value=!0,y.value=C("role.addRole"),L.value={}},a=e=>{w.delRole(e).then(()=>{l()})},r=e=>{k.value=!0,y.value=C("role.editRole"),L.value=e},A=U("users","create"),K=U("users","update"),N=U("users","delete"),v=U("users","query");return(e,d)=>{const x=_("a-button"),Q=_("a-switch"),W=_("a-space"),X=_("a-table");return n(),b("div",null,[s(v)?(n(),b("div",j,[i(s(G),P(f.value,{modelValue:V.value,"onUpdate:modelValue":d[0]||(d[0]=u=>V.value=u),onSubmit:l,onReset:l}),null,16,["modelValue"])])):p("",!0),Y("div",q,[Y("div",F,[s(A)?(n(),$(x,{key:0,class:"mr-10",type:"primary",size:"small",onClick:B},{default:c(()=>[I(g(e.$t("form.add")),1)]),_:1})):p("",!0),i(s(re),{columns:s(te),tableColumns:S.value,"onUpdate:tableColumns":d[1]||(d[1]=u=>S.value=u)},null,8,["columns","tableColumns"])]),i(X,{columns:S.value,dataSource:h.value,pagination:t,scroll:{x:"max-content"},onChange:m},{bodyCell:c(({column:u,record:z,index:Z})=>[u.dataIndex==="index"?(n(),b(pe,{key:0},[I(g(Z+1),1)],64)):p("",!0),u.dataIndex==="enable"?(n(),b("span",D,[i(Q,{"checked-children":e.$t("form.start"),"un-checked-children":e.$t("form.disable"),checkedValue:1,unCheckedValue:0,checked:z.enable,"onUpdate:checked":O=>z.enable=O},null,8,["checked-children","un-checked-children","checked","onUpdate:checked"])])):p("",!0),["createAt","updateAt"].includes(u.dataIndex)?(n(),b("span",E,g(e.$filters.formatTime(z[u.dataIndex])),1)):p("",!0),["action"].includes(u.dataIndex)?(n(),$(W,{key:3,wrap:""},{default:c(()=>[s(K)?(n(),$(x,{key:0,size:"small",type:"link",onClick:O=>r(z)},{default:c(()=>[i(s(fe)),I(g(e.$t("form.edit")),1)]),_:2},1032,["onClick"])):p("",!0),s(N)?(n(),$(x,{key:1,size:"small",type:"link",danger:"",onClick:O=>a(z.id)},{default:c(()=>[i(s(ve)),I(" "+g(e.$t("form.delete")),1)]),_:2},1032,["onClick"])):p("",!0)]),_:2},1024)):p("",!0)]),_:1},8,["columns","dataSource","pagination"])]),i(T,{modelValue:k.value,"onUpdate:modelValue":d[2]||(d[2]=u=>k.value=u),title:y.value,info:L.value,onGetList:l},null,8,["modelValue","title","info"])])}}})});export{_e as __tla,H as default};
