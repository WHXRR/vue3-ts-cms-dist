import{r as J,a as W,__tla as X}from"./config-36c03ce1.js";import{r as Z,C as q,__tla as ee}from"./config-ed41f558.js";import{_ as ae}from"./ControlTableColumnsBtn.vue_vue_type_script_setup_true_lang-b5ef20a1.js";import{u as G}from"./vue-i18n-03843db8.js";import"./vuedraggable-4f66b711.js";import{c as x,__tla as te}from"./index-9a0b135b.js";import{m as le}from"./ant-design-vue-43b44ce6.js";import{d as M,e as oe,j as n,w as ne,aY as v,aQ as y,ab as w,c as a,bu as d,E as I,b8 as b,u as g,aI as P,r as re,ac as L,F as ie,aa as U,a9 as ue}from"./@vue-3199b24e.js";import{_ as se,T as me}from"./@ant-design-5e74ab0d.js";import"./@intlify-f45a2def.js";import"./dayjs-63e4896c.js";import"./vue-75222be8.js";import"./sortablejs-840e720b.js";import"./pinia-d1156740.js";import"./vue-router-60a88f34.js";import"./axios-82afda87.js";import"./nprogress-f5d56be4.js";import"./@babel-727ea1f3.js";import"./@ctrl-fb5a5473.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-fad5b415.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-0b7bf9f6.js";import"./dom-align-ecb06dd6.js";import"./lodash-es-fa11e39e.js";import"./async-validator-7f96df71.js";import"./throttle-debounce-87e7e444.js";let Q,de=Promise.all([(()=>{try{return X}catch{}})(),(()=>{try{return ee}catch{}})(),(()=>{try{return te}catch{}})()]).then(async()=>{const A=[];function K(C){for(const s of C)s.children?K(s.children):A.push(s.id);return A}let N,O,j,E,F,T;N=M({__name:"AddRole",props:{modelValue:{type:Boolean,default:!1},title:{type:String,required:!0},info:{type:Object,default:()=>{}}},emits:["update:modelValue","getList"],setup(C,{emit:s}){const c=C,{t:V}=G(),h=oe({get:()=>c.modelValue,set:t=>{s("update:modelValue",t)}}),S=n({formItems:Z,formName:"role",colStyle:{sm:24},showCollapsed:!1,showResetBtn:!1,showSubmitBtn:!1}),l=n(),o=n({name:"",intro:""});ne(()=>c.info,t=>{c.info.id?m.value=K(t.menuList):m.value=[],Object.keys(o.value).forEach(r=>{o.value[r]=t[r]})});const m=n([]),_={title:"name",key:"id"},k=n([]);x.getMenuList().then(t=>{k.value=t.data.list});const z=()=>{if(!m.value.length)return le.warn(V("form.selectIntro"));l.value.submit()},$=async()=>{const t={...o.value,menuList:m.value};c.info.id?await x.editRole(t,c.info.id):await x.addRole(t),s("getList"),m.value=[],l.value.reset(),h.value=!1};return(t,r)=>{const e=v("a-tree"),u=v("a-button"),p=v("a-modal");return y(),w("div",null,[a(p,{open:h.value,"onUpdate:open":r[2]||(r[2]=f=>h.value=f),title:C.title,destroyOnClose:""},{footer:d(()=>[a(u,{type:"primary",size:"small",onClick:z},{default:d(()=>[I(b(t.$t("form.submit")),1)]),_:1})]),default:d(()=>[a(g(q),P(S.value,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=f=>o.value=f),onSubmit:$,ref_key:"formRef",ref:l}),null,16,["modelValue"]),a(e,{checkedKeys:m.value,"onUpdate:checkedKeys":r[1]||(r[1]=f=>m.value=f),"tree-data":k.value,"field-names":_,checkable:""},null,8,["checkedKeys","tree-data"])]),_:1},8,["open","title"])])}}}),O={class:"search-form"},j={class:"mt-20"},E={class:"options"},F={key:1},T={key:2},Q=M({__name:"Role",setup(C){const{t:s}=G(),c=n({formName:"roleList",formItems:J,formLabelCol:{sm:{span:8}}}),V=n({name:"",intro:""}),h=n([]),S=n([]),l=re({total:0,current:1,pageSize:10}),o=()=>{x.getRoleList({offset:l.pageSize*l.current-l.pageSize,size:l.pageSize,...V.value}).then(e=>{const{list:u,totalCount:p}=e.data;h.value=u,l.total=p})},m=e=>{l.current=e.current,l.pageSize=e.pageSize,o()};o();const _=n(!1),k=n(""),z=n({}),$=()=>{_.value=!0,k.value=s("role.addRole"),z.value={}},t=e=>{x.delRole(e).then(()=>{o()})},r=e=>{_.value=!0,k.value=s("role.editRole"),z.value=e};return(e,u)=>{const p=v("a-button"),f=v("a-switch"),Y=v("a-space"),D=v("a-table");return y(),w("div",null,[L("div",O,[a(g(q),P(c.value,{modelValue:V.value,"onUpdate:modelValue":u[0]||(u[0]=i=>V.value=i),onSubmit:o,onReset:o}),null,16,["modelValue"])]),L("div",j,[L("div",E,[a(p,{class:"mr-10",type:"primary",size:"small",onClick:$},{default:d(()=>[I(b(e.$t("form.add")),1)]),_:1}),a(g(ae),{columns:g(W),tableColumns:S.value,"onUpdate:tableColumns":u[1]||(u[1]=i=>S.value=i)},null,8,["columns","tableColumns"])]),a(D,{columns:S.value,dataSource:h.value,pagination:l,scroll:{x:"max-content"},onChange:m},{bodyCell:d(({column:i,record:R,index:H})=>[i.dataIndex==="index"?(y(),w(ie,{key:0},[I(b(H+1),1)],64)):U("",!0),i.dataIndex==="enable"?(y(),w("span",F,[a(f,{"checked-children":e.$t("form.start"),"un-checked-children":e.$t("form.disable"),checkedValue:1,unCheckedValue:0,checked:R.enable,"onUpdate:checked":B=>R.enable=B},null,8,["checked-children","un-checked-children","checked","onUpdate:checked"])])):U("",!0),["createAt","updateAt"].includes(i.dataIndex)?(y(),w("span",T,b(e.$filters.formatTime(R[i.dataIndex])),1)):U("",!0),["action"].includes(i.dataIndex)?(y(),ue(Y,{key:3,wrap:""},{default:d(()=>[a(p,{size:"small",type:"link",onClick:B=>r(R)},{default:d(()=>[a(g(se)),I(b(e.$t("form.edit")),1)]),_:2},1032,["onClick"]),a(p,{size:"small",type:"link",danger:"",onClick:B=>t(R.id)},{default:d(()=>[a(g(me)),I(" "+b(e.$t("form.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)):U("",!0)]),_:1},8,["columns","dataSource","pagination"])]),a(N,{modelValue:_.value,"onUpdate:modelValue":u[2]||(u[2]=i=>_.value=i),title:k.value,info:z.value,onGetList:o},null,8,["modelValue","title","info"])])}}})});export{de as __tla,Q as default};
